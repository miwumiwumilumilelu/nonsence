## **互联网广告平台 MVP 项目启动规划建议 (最终版 - 无 Redis/Celery, 含简化发票)**

**项目:** 基于 Web 的互联网广告平台 (MVP)
**团队:** 4 名开发人员
**核心约束:** Python 后端，PostgreSQL 数据库，2 个月完成 MVP

### 1. 需求分析细化与 MVP 界定

为了在 2 个月内交付核心价值，我们需要精确定义 MVP (Minimum Viable Product) 范围，并对需求进行分解。

**用户角色:**

- **广告主 (Advertiser):** 创建广告、充值、管理广告、查看效果、申请发票。
- **平台管理员 (Admin):** 审核广告、管理用户（可能需要）、管理发票请求。

**功能需求分解 & MVP 范围:**





| 核心需求                 | 子功能点/用户故事 (User Stories)                             | MVP 优先级        | 备注 (简化点)                                                |
| ------------------------ | ------------------------------------------------------------ | ----------------- | ------------------------------------------------------------ |
| **用户基础**             | Advertiser/Admin 注册与登录                                  | **核心**          | 标准的用户认证                                               |
| **1. 广告购买与审核**    | Advertiser: 创建广告表单（名称, 目标 URL, 上传素材图片, 设定每日预算/总预算, 选择投放时间段） | **核心**          | 预算/排期设置简化，素材仅支持单图片                          |
|                          | Advertiser: 提交广告进行审核                                 | **核心**          |                                                              |
|                          | Advertiser: 查看自己广告列表及其状态（待审核/通过/拒绝/投放中/暂停/结束） | **核心**          | 状态流转清晰                                                 |
|                          | Admin: 查看待审核广告列表                                    | **核心**          | (可通过 Django Admin 实现)                                   |
|                          | Admin: 查看广告详情并进行审核（通过/拒绝，可附带简单理由）   | **核心**          | 拒绝理由简化为文本框 (可通过 Django Admin 实现)              |
| **2. 广告账户充值**      | Advertiser: 进入充值页面，输入金额                           | **核心**          |                                                              |
|                          | Advertiser: 点击“充值”按钮，触发模拟支付成功逻辑，账户余额增加 | **核心**          | 无需对接真实支付网关，后端直接更新余额并记录                 |
| **3. 充值历史浏览**      | Advertiser: 查看个人充值记录列表（时间、金额、状态-如成功）  | **核心**          | 简单列表展示                                                 |
| **4. 广告管理**          | Advertiser: 在广告列表中，对“已通过”的广告进行“暂停”/“恢复”操作 | **核心**          | MVP 优先支持暂停/恢复，编辑功能（预算/排期/素材）可 V2 实现  |
|                          | Advertiser: 查看广告详情（创建时填写的那些信息）             | **核心**          |                                                              |
| **5. 广告效果报告**      | Advertiser: 查看名下各广告的基础数据（总展示量、总点击量）   | **核心**          | 仅需展示总数，按天/按小时等细粒度报表 V2 实现。点击量统计和扣费可简化或推迟。 |
|                          | 后端: 记录广告展示次数 (Impression) - **直接写入数据库**     | **核心**          | 点击 (Click) 记录和处理作为次高优先级，若时间紧张可先不上报/统计点击 |
| **6. 广告投放接口**      | 提供一个 HTTP API 接口，接收参数（如广告位标识符 placement_id），返回一个符合条件的、可投放的广告信息（素材 URL, 跳转链接） - **直接查询数据库** | **核心**          | 匹配逻辑简化：随机/轮询返回一个状态为“投放中”且预算充足的广告 (直接查询 PG)。无需复杂定向。 |
|                          | 该接口被调用时，应记录一次广告展示 (Impression) - **直接写入数据库日志表** | **核心**          | 这是效果报告的数据来源                                       |
| **7. 发票开具 (简化版)** | Advertiser: 提供简单的“申请发票”入口，可选择基于时间段的消费/充值记录 | **核心 (简化版)** | 仅记录申请，**不涉及**实际 PDF 生成、复杂计算和税务逻辑。    |
|                          | Advertiser: 查看发票申请记录及其状态（待处理/已处理）        | **核心 (简化版)** | 简单列表展示                                                 |
|                          | Admin: 查看所有发票申请列表                                  | **核心 (简化版)** | (可通过 Django Admin 实现)                                   |
|                          | Admin: 将发票申请标记为“已处理”                              | **核心 (简化版)** | (可通过 Django Admin 实现)                                   |

**核心业务流程识别:**

1. **广告生命周期:** 创建 -> 待审核 -> (拒绝) / 通过 -> 待投放 (根据排期) -> 投放中 <-> 暂停 -> 结束 (预算耗尽/到期)。
2. **充值流程:** 用户发起充值 -> (模拟)支付成功 -> 更新账户余额 -> 记录充值流水。
3. **广告投放与计费 (MVP 简化版):** 广告请求 -> (简单匹配，**查 PG** ) 选择广告 -> 返回广告信息 -> **记录展示次数到 PG 日志表** -> (简化版扣费逻辑，**读写 PG** )。
4. **发票流程 (简化版):** 广告主提交申请 (选择时间范围) -> 系统记录申请 (状态：待处理) -> 管理员查看申请 -> 管理员标记为已处理 (状态：已处理)。

**MVP 结论:** 核心是让广告主能**创建广告**、平台能**审核**、广告主能**充值**、广告能通过**接口被展示**并**记录基础展示数据（直接操作数据库）**、广告主能**申请发票（简化流程）**、管理员能**处理发票申请（简化操作）**。管理（暂停/恢复）和历史查看是必要的辅助功能。复杂的广告编辑/报表、真实的支付/发票生成被排除。**不引入 Redis/Celery 以简化技术栈。**

### 2. 技术栈选型推荐

考虑到团队熟悉 Python、必须使用 PostgreSQL 以及 2 个月的 MVP 时间限制，并**优先保证功能实现，简化技术复杂度**：

- **后端:** **Python + Django**
  - **理由:**
    - **团队熟悉度:** 直接利用现有技能，减少学习成本，加速开发。
    - **开发效率:** Django "Batteries Included" 的特性（ORM、Admin、表单、认证）能极大提高开发效率，尤其适合快速构建 MVP。自带的 Admin 后台能快速满足管理员审核广告、处理发票申请的需求。
    - **生态成熟:** 拥有丰富的第三方库支持。
    - **PostgreSQL 支持:** Django ORM 对 PostgreSQL 有良好支持。
- **前端:** **Vue.js**
  - **理由:**
    - **学习曲线:** 通常认为 Vue 比 React 更易上手，有助于前端快速进入开发状态。
    - **开发体验:** 提供了清晰的文档和 CLI 工具 (Vue CLI)，开发体验良好。
    - **性能:** 性能优异，满足 Web 应用需求。
    - **渐进式:** 可以从简单页面开始，逐步引入复杂特性和状态管理 (Vuex)。
  - *备选: React。生态更庞大，社区支持极好，也是非常好的选择，但相对学习曲线稍陡峭。如果团队已有 React 经验则优先考虑 React。*
  - ***重要提示:*** *选择 Vue.js 意味着采用前后端分离架构。这会增加 API 设计、联调和部署的复杂度。请确保团队对此有预期并优先进行 API 设计。*
- **数据库:** **PostgreSQL** (已指定)
  - **理由:** 功能强大、稳定可靠的关系型数据库，支持复杂查询和事务，适合广告平台这种需要数据一致性的场景。Django ORM 支持良好。
- **缓存:** **无特定缓存技术 (初期)**
  - **策略:** 对于课程设计级别的访问量，直接查询数据库通常足够。Django ORM 会有一些基本的查询缓存，但应用层面不引入 Redis 等外部缓存系统。
- **异步/定时任务:** **无特定任务队列 (初期)**
  - **策略:** MVP 阶段避免需要复杂后台任务的逻辑（如扣费简化）。如果需要简单的定时任务（如每日检查广告状态），可以编写 Django Management Command，然后使用操作系统的 cron (Linux/macOS) 或任务计划程序 (Windows) 来定时执行。
- **API 风格:** RESTful API (若采用前后端分离)

### 3. 高层项目结构/模块划分 (基于 Django)

建议采用前后端分离架构。后端 Django 项目可以按 App 进行模块化：

```
ad_platform_project/
├── manage.py
├── ad_platform_project/  # Django 项目配置
│
├── apps/                 # 所有业务 App
│   ├── **users/**        # 用户认证与管理
│   │   ├── models.py
│   │   ├── serializers.py
│   │   ├── views.py
│   │   └── urls.py
│   │
│   ├── **accounts/**     # 账户与账单
│   │   ├── models.py     # Account(余额), Transaction(流水)
│   │   ├── services.py
│   │   ├── views.py
│   │   └── urls.py
│   │
│   ├── **ads/**          # 广告核心管理
│   │   ├── models.py     # Ad, AdPlacement(可选)
│   │   ├── admin.py      # ***重点利用，处理审核***
│   │   ├── services.py
│   │   ├── views.py      # 广告主 CRUD API
│   │   └── urls.py
│   │
│   ├── **delivery/**     # 广告投放接口
│   │   ├── services.py   # 广告选择逻辑 (直接读 PG)
│   │   ├── views.py      # 广告获取 API
│   │   └── urls.py
│   │
│   ├── **reporting/**    # 数据统计与报告
│   │   ├── models.py     # AdImpressionLog, AdClickLog(可选)
│   │   ├── services.py   # 数据聚合逻辑 (直接读 PG Log)
│   │   ├── views.py      # 效果数据查询 API
│   │   └── urls.py
│   │
│   └── **invoicing/**    # ***发票管理 (简化版)***
│       ├── models.py     # InvoiceRequest (申请人, 时间范围, 状态, 金额等)
│       ├── admin.py      # ***重点利用，处理发票请求***
│       ├── serializers.py # (如果提供 API)
│       ├── views.py      # Advertiser 申请 API, 查看列表 API
│       └── urls.py       # Admin 处理 API (如果不用 admin action)
│
├── static/             # 全局静态文件
├── templates/          # Django 模板 (主要用于 Admin)
├── requirements.txt    # Python 依赖
└── venv/               # 虚拟环境
```

content_copydownload

Use code [with caution](https://support.google.com/legal/answer/13505487).

**模块核心职责 (调整后):**

- **users:** 用户身份认证、授权、信息。
- **accounts:** 账户余额、充值、流水。
- **ads:** 广告创建、状态、内容管理。**管理员审核主要通过 Django Admin 实现。**
- **delivery:** 提供广告投放接口，**直接查询 PostgreSQL** 选择广告，**直接向 PostgreSQL 写入展示记录**。
- **reporting:** 收集、聚合效果数据，**直接从 PostgreSQL 日志表查询**。
- **invoicing:** 处理**简化的**发票申请流程。广告主提交申请，**管理员主要通过 Django Admin 查看和处理申请**。

### 4. 4 人团队任务分配建议 (2 后端, 2 前端)

- **后端开发人员 1 (BE1):**
  - **主要负责:** users (认证授权), accounts (账户余额、充值、流水), invoicing (发票申请模型、API、Admin 配置)。
  - **职责:** 相关数据库模型设计与实现, 核心认证 API, 充值模拟接口, 交易历史 API, **发票申请 API 和 Admin 配置**, 单元测试。
  - **协作:** 与 BE2 协调账户扣款（广告消费）的接口或逻辑。
- **后端开发人员 2 (BE2):**
  - **主要负责:** ads (广告管理核心), delivery (广告投放接口), reporting (基础统计)。
  - **职责:** 相关数据库模型设计与实现, 广告 CRUD 及状态管理 API, **广告审核逻辑 (重点利用 Django Admin)**, 广告投放 API 实现 (**直接查询 PG**), Impression **记录逻辑 (写入 PG Log 表)**, 基础数据聚合与查询 API (**基于 PG Log 表**), 单元测试。
  - **协作:** 需要调用 accounts 模块进行扣费（或至少记录待扣费），为 reporting 提供数据源。
- **前端开发人员 1 (FE1):**
  - **主要负责:** **广告主端 (Advertiser Portal)** 核心功能。
  - **职责:** 搭建前端项目框架 (Vue CLI), 实现登录/注册, Dashboard, 广告创建/列表/管理, 充值页面/历史, **发票申请表单/历史列表**。对接 BE1 和 BE2 提供的 API。
  - **协作:** 与 FE2 共享通用组件库和样式规范。
- **前端开发人员 2 (FE2):**
  - **主要负责:** **管理员端 (Admin Portal)** (如果 Django Admin 不足) + **广告主端** 的 **效果报告** 部分 + **通用组件/库**。
  - **职责:** **(优先评估 Django Admin 是否满足需求)** 如果需要单独的 Admin 前端，则负责实现。否则，重点实现广告主端的效果报告展示页面。开发或集成通用 UI 组件库。对接 BE2 的报告 API。
  - **协作:** **强烈建议最大化利用 Django Admin 处理广告审核和发票请求**，以减轻 FE2 工作量。

### 5. 前后端主要任务分解

**前端团队 (FE1 & FE2):**

- 框架搭建, 页面实现 (Advertiser Portal, Admin Portal - 按需), 交互逻辑, 通用组件。
- **新增:** 发票申请表单页面、发票申请历史列表页面。

**后端团队 (BE1 & BE2):**

- 框架搭建, 数据库建模 (PG), 核心业务逻辑实现, API 接口实现 (使用 DRF)。
- **后台管理:** **重点配置 Django Admin Site** 以便管理员快速进行**广告审核**和**发票请求处理**。
- **新增:**
  - invoicing App: InvoiceRequest 模型定义, 广告主提交申请的 API, 查看申请列表的 API (可选，也可只用 Admin)。
  - 配置 InvoiceRequest 模型的 Admin 界面，添加处理状态的 Action。
- **移除:** 无需考虑 Redis/Celery 相关配置和逻辑。



**总结与建议:**

- **MVP 聚焦:** 严格遵守 MVP 范围，优先打通核心流程。简化版发票功能已纳入。
- **简化技术栈:** **已移除 Redis/Celery**，计数和投放直接依赖 PostgreSQL。**后台任务优先使用简单方案 (Cron)**。
- **最大化利用 Django Admin:** 这是按时完成 MVP 的关键策略，用于处理管理员的审核和发票管理任务。
- **沟通协作:** 强调前后端接口先行定义，每日站会同步进度和阻塞点。
- **测试:** 核心模块需要基本的单元测试覆盖。
- **部署:** 尽早考虑简单的部署方案。